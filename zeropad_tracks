export i
find -type d|while read d; do pushd "$d"; find -maxdepth 1|sed s_^\\./__|grep -o ^[0-9]\\+\ |awk ' { if ( length > L ) { L=length} }END{ if (L>2){print L - 1}}'|(read j && find -maxdepth 1|sed s_^\\./__|grep ^[0-9]\\+\ |while read i; do n=`echo "$i"| grep -o ^[0-9]*`; dst="$(printenv i |sed s/^[0-9]*/$(printf "%0${j}d\n" ${n##+(0)})/)"; [ "$i" != "$dst" ] && mv -v "$i" "$dst"; done); popd > /dev/null; done
